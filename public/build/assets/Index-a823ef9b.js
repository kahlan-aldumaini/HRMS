import{A as k}from"./AppLayout-e055a3fb.js";import{_ as S,I as M}from"./_plugin-vue_export-helper-d97591f4.js";import{_ as H,S as j,D as I,F as U,L as z}from"./FormDropDown-d545c5d5.js";import{T as K,O as V,k as h,r as u,o as r,c as i,a as e,n as D,h as R,w as g,p as F,e as d,b as c,f as l,t as a,F as f,l as y,d as b,g as m,i as C}from"./app-65af30ef.js";import{_ as q}from"./BlueButton-a8ab83bf.js";import{a as J,D as P}from"./DropdownList-9b3ede74.js";import{S as Q}from"./ShowModel-4bc20b91.js";import{F as W}from"./Filter-7e2e6f35.js";const X={components:{TableCard:H,Icon:M,BlueButton:q,DropdownList:J,DropDownOption:P,SecondaryButton:j,DangerButton:I,FormDropDown:U,ShowModel:Q,Filter:W},props:{fingerprints:Array,filter:Object},created(){this.getEmployees(),this.$page.props.role=="employee"&&(this.newEmpFingerprint.type="employee",this.newEmpFingerprint.employee=this.$page.props.auth.user.id,this.currentEmp=this.$page.props.auth.user.name,this.getShiftByGroupOrEmployee(this.$page.props.auth.user.id))},data(){return{showAddNew:!1,employees:[],currentEmp:"",Vactions:[],groups:[],currentVacation:"",currentGroup:"",newEmpFingerprint:K({employee:"",hours:"",login:"",exit:"",type:"",vaction:"",group:"",shift_id:""}),shifts:[],editId:0,vacationData:null,showVacation:!1,showFilter:!1,loadingClearFilter:!1,filterKeys:["group","from_date","to_date"],filterData:this.filter}},watch:{"newEmpFingerprint.type":function(n){this.getVacations(),n=="employee"?this.getEmployees():n=="group"&&this.getGroup()}},methods:{hideFilter(){this.showFilter=!1},filterSuccess(){this.toast("","تم فلترة  الاجازات بنجاح"),this.hideFilter()},clearFilter(){this.loadingClearFilter=!0,V.get("/vacations",{},{onSuccess:()=>{this.toast("","تم تصفية فلتر الاجازات بنجاح"),this.loadingClearFilter=!1}})},getEmployees(){h.get("/get-employees").then(n=>{this.employees=n.data}).catch(n=>console.log(n))},selectFun(n){this.currentEmp=n.user.name,this.newEmpFingerprint.employee=n.id,this.getVacations(),this.getShiftByGroupOrEmployee(n.id)},submit(){this.newEmpFingerprint.post("/add-new-vaction",{onSuccess:()=>{this.showAddNew=!1,this.toast("","تمت اظافة الاجازة بنجاح")},onError:n=>{n.message&&this.toast("",n.message,"error")}})},getVacations(){this.newEmpFingerprint.type=="employee"?h.get("/get-vacations-for-emp/"+this.newEmpFingerprint.employee).then(n=>{this.Vactions=n.data}).catch(n=>console.log(n)):h.get("/get-vacations/").then(n=>{this.Vactions=n.data}).catch(n=>console.log(n))},getGroup(){h.get("/get-groups").then(n=>{this.groups=n.data}).catch(n=>console.log(n))},async getShiftByGroupOrEmployee(n){await h.get("/get-shift?id="+n+"&type="+this.newEmpFingerprint.type).then(o=>{this.shifts=o.data})},async showVacationFunction(n){this.showVacation=!0,this.editId=n,await h.get("/get-vacation/"+n).then(o=>{this.vacationData=o.data})},hideShowVacationModel(){this.showVacation=!1,this.editId=0,this.vacationData=null},approved(n){V.get("/approved-vacation/"+n,{},{onSuccess:o=>{this.toast("","تمت الموافقة على الاجازة")}})}}},Y={class:"relative w-full h-full"},Z=e("div",{class:"flex items-center jusc"},[e("div",{class:"px-4 py-2 mt-2 mb-4 text-xl font-semibold text-center w-max"}," اظافة اجازه ")],-1),$={key:0,class:"w-full mb-4"},ee=e("span",{class:"block mb-4 mr-4 text-sm font-semibold"},"نوع الاجازة",-1),te={class:"flex items-center justify-evenly"},se={class:"flex items-center px-4"},ne=e("span",{class:"mr-2"}," موظف محدد ",-1),oe={class:"flex items-center px-4"},re=e("span",{class:"mr-2"},"مجموعة محدده",-1),le={class:"flex items-center px-4"},ie=e("span",{class:"mr-2"},"كل الموظف",-1),pe={class:"grid w-full grid-cols-2 gap-2"},ae={key:0,class:"block w-full mb-4"},ce=e("span",{class:"block mb-1 mr-4 text-sm font-semibold"},"اسم الموظف",-1),de={class:"px-2 border rounded-md"},ue={class:"px-1"},me=["innerHTML"],he={class:"block w-full mb-4"},_e=e("span",{class:"block mb-1 mr-4 text-sm font-semibold"},"الاجازات",-1),ge={class:"px-2 border rounded-md"},fe={class:"px-1"},we=["innerHTML"],ye={key:1,class:"block w-full mb-4"},be=e("span",{class:"block mb-1 mr-4 text-sm font-semibold"},"المجموعة",-1),xe={class:"px-2 border rounded-md"},ve={class:"px-1"},Fe=["innerHTML"],Ee={class:"block w-full mb-4"},ke=e("span",{class:"block mb-1 mr-4 text-sm font-semibold"},"تاريخ البدء",-1),Ve={class:"flex items-center px-4 border rounded-md"},De=["innerHTML"],Ce={class:"block w-full mb-4"},Se=e("span",{class:"block mb-1 mr-4 text-sm font-semibold"},"تاريخ الانتهاء",-1),Me={class:"flex items-center px-4 border rounded-md"},Be=["innerHTML"],Le={class:"flex items-center justify-between w-full py-2"},Te={class:"flex items-center justify-between w-full"},Ae=e("p",{class:"text-xl font-semibold"},"عرض الاجازات",-1),Ne={class:"grid grid-cols-3 gap-2"},Oe=e("th",null,"الاسم",-1),Ge=e("th",{class:"py-2"},"رقم الكود",-1),He=e("th",null,"نوع الاجازة",-1),je=e("th",null,"تاريخ البدء",-1),Ie=e("th",null,"تاريخ الانتهاء",-1),Ue=e("th",null,"حالة الاجازة",-1),ze=e("th",null,"تمت الموافقة",-1),Ke=e("th",null,"خيارات",-1),Re={class:"flex items-center justify-evenly h-14"},qe=["onClick"],Je=["onClick"];function Pe(n,o,x,B,t,p){const _=u("DropDownOption"),v=u("DropdownList"),L=u("FormDropDown"),E=u("BlueButton"),T=u("Filter"),A=u("ShowModel"),N=u("secondary-button"),O=u("danger-button"),G=u("TableCard");return r(),i(f,null,[e("div",{class:D(["absolute top-0 right-0 w-full h-full transition-all duration-300 ease-linear cursor-pointer",t.showAddNew?"z-50":"-z-50"])},[e("div",Y,[e("div",{class:"absolute w-full h-full bg-gray-200 opacity-75",onClick:o[0]||(o[0]=s=>t.showAddNew=!1)}),e("div",{class:D(["absolute transition-all duration-500 -translate-y-1/2 bg-white border shadow-lg w-max top-1/2 left-1/2 h-max rounded-xl",t.showAddNew?"-translate-x-1/2 ":"-translate-x-1/3 "])},[Z,e("form",{onSubmit:o[8]||(o[8]=R((...s)=>p.submit&&p.submit(...s),["prevent"])),class:"px-2 w-[500px]"},[n.$page.props.role!="employee"?(r(),i("div",$,[ee,e("div",te,[e("label",se,[g(e("input",{type:"radio",value:"employee",name:"type","onUpdate:modelValue":o[1]||(o[1]=s=>t.newEmpFingerprint.type=s),class:"pr-1 text-sm bg-transparent border focus:ring-0"},null,512),[[F,t.newEmpFingerprint.type]]),ne]),e("label",oe,[g(e("input",{type:"radio",value:"group",name:"type","onUpdate:modelValue":o[2]||(o[2]=s=>t.newEmpFingerprint.type=s),class:"pr-1 text-sm bg-transparent border focus:ring-0 text-primary"},null,512),[[F,t.newEmpFingerprint.type]]),re]),e("label",le,[g(e("input",{onChange:o[3]||(o[3]=s=>p.getShiftByGroupOrEmployee(0)),type:"radio",value:"all",name:"type","onUpdate:modelValue":o[4]||(o[4]=s=>t.newEmpFingerprint.type=s),class:"pr-1 text-sm bg-transparent border focus:ring-0 text-primary"},null,544),[[F,t.newEmpFingerprint.type]]),ie])])])):d("",!0),e("div",pe,[t.newEmpFingerprint.type=="employee"&&n.$page.props.role!="employee"?(r(),i("label",ae,[ce,e("div",de,[c(v,null,{button:l(()=>[e("div",ue,a(t.currentEmp),1)]),items:l(()=>[(r(!0),i(f,null,y(t.employees,s=>(r(),b(_,{class:"hover:bg-blue-500",key:s.id,select:w=>p.selectFun(s)},{default:l(()=>[m(a(s.user.name),1)]),_:2},1032,["select"]))),128))]),_:1})]),t.newEmpFingerprint.errors.employee!=null?(r(),i("small",{key:0,class:"mt-1 mr-4 text-xs font-semibold text-red-800",innerHTML:t.newEmpFingerprint.errors.employee},null,8,me)):d("",!0)])):d("",!0),e("label",he,[_e,e("div",ge,[c(v,null,{button:l(()=>[e("div",fe,a(t.currentVacation),1)]),items:l(()=>[(r(!0),i(f,null,y(t.Vactions,s=>(r(),b(_,{class:"hover:bg-blue-500",key:s.id,select:w=>{t.newEmpFingerprint.vaction=s.id,t.currentVacation=s.name}},{default:l(()=>[m(a(s.name),1)]),_:2},1032,["select"]))),128))]),_:1})]),t.newEmpFingerprint.errors.employee!=null?(r(),i("small",{key:0,class:"mt-1 mr-4 text-xs font-semibold text-red-800",innerHTML:t.newEmpFingerprint.errors.employee},null,8,we)):d("",!0)]),t.newEmpFingerprint.type=="group"?(r(),i("label",ye,[be,e("div",xe,[c(v,null,{button:l(()=>[e("div",ve,a(t.currentGroup),1)]),items:l(()=>[(r(!0),i(f,null,y(t.groups,s=>(r(),b(_,{class:"hover:bg-blue-500",key:s.id,select:w=>{t.newEmpFingerprint.group=s.id,t.currentGroup=s.name,p.getShiftByGroupOrEmployee(s.id)}},{default:l(()=>[m(a(s.name),1)]),_:2},1032,["select"]))),128))]),_:1})]),t.newEmpFingerprint.errors.group!=null?(r(),i("small",{key:0,class:"mt-1 mr-4 text-xs font-semibold text-red-800",innerHTML:t.newEmpFingerprint.errors.group},null,8,Fe)):d("",!0)])):d("",!0),e("label",Ee,[ke,e("div",Ve,[g(e("input",{type:"date","onUpdate:modelValue":o[5]||(o[5]=s=>t.newEmpFingerprint.login=s),class:"pr-1 text-sm bg-transparent border-0 focus:ring-0"},null,512),[[C,t.newEmpFingerprint.login]])]),t.newEmpFingerprint.errors.login!=null?(r(),i("small",{key:0,class:"mt-1 mr-4 text-xs font-semibold text-red-800",innerHTML:t.newEmpFingerprint.errors.login},null,8,De)):d("",!0)]),e("label",Ce,[Se,e("div",Me,[g(e("input",{type:"date","onUpdate:modelValue":o[6]||(o[6]=s=>t.newEmpFingerprint.exit=s),class:"pr-1 text-sm bg-transparent border-0 focus:ring-0"},null,512),[[C,t.newEmpFingerprint.exit]])]),t.newEmpFingerprint.errors.exit!=null?(r(),i("small",{key:0,class:"mt-1 mr-4 text-xs font-semibold text-red-800",innerHTML:t.newEmpFingerprint.errors.exit},null,8,Be)):d("",!0)])]),c(L,{label:"الدوام",modelValue:t.newEmpFingerprint.shift_id,error:t.newEmpFingerprint.errors.shift_id,selectData:t.shifts,selectFun:s=>t.newEmpFingerprint.shift_id=s},null,8,["modelValue","error","selectData","selectFun"]),e("div",Le,[c(E,{type:"submit"},{default:l(()=>[m(" حفظ ")]),_:1}),e("button",{type:"reset",onClick:o[7]||(o[7]=s=>t.showAddNew=!1),class:"w-full py-2 mx-2 text-sm font-semibold text-white bg-red-500 rounded-full"}," الغاء ")])],32)],2)])],2),c(T,{show:t.showFilter,filter:t.filterData,hide:p.hideFilter,url:"/vacations",success:p.filterSuccess,only:t.filterKeys},{header:l(()=>[m(" فلتر الاجازات ")]),_:1},8,["show","filter","hide","success","only"]),c(A,{show:t.showVacation,title:"عرض الاجازه",items:t.vacationData,hide:p.hideShowVacationModel},null,8,["show","items","hide"]),c(G,null,{header:l(()=>[e("div",Te,[Ae,e("div",Ne,[t.employees.length?(r(),b(E,{key:0,onClick:o[9]||(o[9]=s=>{t.showAddNew=!0,p.getEmployees()}),class:"px-4 py-1"},{default:l(()=>[m(" اظافة اجازه ")]),_:1})):d("",!0),c(N,{onClick:o[10]||(o[10]=s=>t.showFilter=!0)},{default:l(()=>[m(" فلتر ")]),_:1}),c(O,{loading:t.loadingClearFilter,onClick:p.clearFilter},{default:l(()=>[m(" تصفية الفلتر ")]),_:1},8,["loading","onClick"])])])]),table_header:l(()=>[Oe,Ge,He,je,Ie,Ue,ze,Ke]),table_body:l(()=>[(r(!0),i(f,null,y(x.fingerprints,s=>(r(),i("tr",{class:"py-2 text-center border-b-2 h-14",key:s.id},[e("td",null,a(s.user_name),1),e("td",null,a(s.code),1),e("td",null,a(s.type),1),e("td",null,a(s.start),1),e("td",null,a(s.end),1),e("td",null,a(s.state),1),e("td",null,a(s.approved?"تمت الموافقة":"في الانتظار"),1),e("td",Re,[e("div",{class:"cursor-pointer hover:underline",onClick:w=>p.showVacationFunction(s.id)}," عرض ",8,qe),!s.approved&&n.$page.props.role=="manager"?(r(),i("div",{key:0,class:"cursor-pointer hover:underline",onClick:w=>p.approved(s.id)}," موافقة ",8,Je)):d("",!0)])]))),128))]),_:1})],64)}const Qe=S(X,[["render",Pe]]),We={components:{AppLayout:k,Icon:M,Loading:z,Vacation:Qe},layout:k,props:{fingerprints:Array}},Xe={class:"w-full h-full flex items-center justify-between"},Ye={class:"w-full h-full p-1 px-2 overflow-auto bg-slate-100"};function Ze(n,o,x,B,t,p){const _=u("Vacation");return r(),i("div",Xe,[e("div",Ye,[c(_,{fingerprints:x.fingerprints},null,8,["fingerprints"])])])}const it=S(We,[["render",Ze]]);export{it as default};
